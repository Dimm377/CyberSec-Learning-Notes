# Metasploit: Meterpreter

---

- **Room Link:** [Metasploit: Meterpreter](https://tryhackme.com/room/meterpreter)
- **Category:** Exploitation Basics
- **Difficulty:** Easy

---

## Task 1: Introduction to Meterpreter

**Meterpreter** adalah payload canggih dari Metasploit yang berjalan di memory (in-memory) target.

**Keunggulan:**
1.  **Stealthy:** Berjalan di RAM, tidak menulis file ke disk (kecuali kita suruh), sehingga susah dideteksi Antivirus standar.
2.  **Encrypted:** Komunikasi antara attacker dan victim dienkripsi (TLS).
3.  **Powerful:** Bisa upload/download file, dump password, nyalakan kamera/mic, pivoting, dll.

---

## Task 2: Meterpreter Flavors

Meterpreter punya banyak varian tergantung target OS dan cara kerjanya.

**Based on Platform:**
- Windows, Linux, Android, macOS, PHP, Python, Java.

**Inline vs Staged:**
- **Inline (Single):** Payload utuh dikirim sekaligus. Lebih stabil tapi ukurannya besar.
- **Staged:** Dikirim bertahap.
  1.  **Stager (Stage 0):** Kode kecil untuk connect balik ke attacker.
  2.  **Stage (Stage 1):** Payload Meterpreter utuh didownload dan dijalankan di memori. Ukuran awal kecil, bagus untuk bypass batasan buffer size exploit.

---

## Task 3: Meterpreter Commands

Setelah berhasil masuk (mendapat sesi `meterpreter >`), kita bisa gunakan banyak command. Ketik `help` untuk lihat semuanya.

**Core Commands:**
- `background`: Menaruh sesi ke background (kembali ke msfconsole).
- `exit`: Menutup sesi.
- `guid`: Melihat Global UID sesi.
- `help`: Menu bantuan.
- `info`: Info tentang module post-exploitation.
- `irb`: Masuk ke mode scripting Ruby.
- `migrate`: Pindah ke proses lain (PENTING untuk persistensi & stabilitas!).

**File System Commands:**
- `cd` / `ls` / `pwd`: Navigasi folder.
- `download [file]`: Download file dari target ke mesin kita.
- `upload [file]`: Upload file dari mesin kita ke target.
- `search -f [nama_file]`: Cari file di seluruh sistem.

---

## Task 4: Post-Exploitation with Meterpreter

Fase setelah berhasil masuk. Di sini kita ngumpulin informasi, eskalasi privilege, atau pivoting.

**Perintah Wajib Tahu:**
1.  **`getuid`**: Siapa user kita sekarang?
    - Output: `Server username: NT AUTHORITY\SYSTEM` (Target utama kita!).
2.  **`sysinfo`**: Informasi sistem (OS, Architecture, Domain, Computer Name).
3.  **`getpid`**: Melihat Process ID (PID) meterpreter kita saat ini.
4.  **`ps`**: Melihat daftar proses yang berjalan.
    - Berguna untuk cari target `migrate`. Sebaiknya migrate ke proses stabil seperti `explorer.exe` atau `lsass.exe`.
5.  **`hashdump`**: Mengambil hash password user (Ntlm). Butuh privilege SYSTEM.
6.  **`shell`**: Masuk ke command prompt (CMD/Bash) native target.
7.  **`load [module]`**: Meload ekstensi tambahan, misal `load kiwi` (Mimikatz).

---

## Task 5: Post-Exploitation Challenge

Mari praktikkan command di atas pada mesin target!

**Cheat Sheet Jawaban:**

- **What is the computer name?**
  - **Answer:** ?
  - *Clue: Gunakan command `sysinfo`.*

- **What is the domain name?**
  - **Answer:** ?
  - *Clue: Masih di `sysinfo`.*

- **What is the name of the share?**
  - **Answer:** ?
  - *Clue: Gunakan module post-exploit `run post/windows/gather/enum_shares` atau `shell` lalu `net share`.*

- **What is the NTLM hash of the user?**
  - **Answer:** ?
  - *Clue: Pastikan sudah SYSTEM, lalu `hashdump`.*

- **What is the Process ID of "explorer.exe"?**
  - **Answer:** ?
  - *Clue: `ps` lalu cari explorer.exe.*

Happy Hacking! üïµÔ∏è‚Äç‚ôÇÔ∏è
